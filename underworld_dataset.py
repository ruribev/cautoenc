import os
import uuid
from typing import Tuple

import numpy as np

from cvae.dataset import generate_profile as generate_sine_profile, normalize

# Pre-sampled surface coordinates extracted from an Underworld simulation
SAMPLED_XC = np.array([
14.08,15.12,15.14,15.16,15.18,15.2,15.22,15.24,15.26,15.28,15.3,15.32,15.34,15.36,15.38,15.4,15.42,15.44,15.46,15.48,15.5,15.52,15.54,15.56,15.58,15.6,15.62,15.64,15.66,15.68,15.7,15.72,15.74,15.76,15.78,15.8,15.82,15.84,15.86,15.88,15.9,15.92,15.94,15.96,15.98,16,16.02,16.04,16.06,16.08,16.1,16.12,16.14,16.16,16.18,16.2,16.22,16.24,16.26,16.28,16.3,16.32,16.34,16.36,16.38,16.4,16.42,16.44,16.46,16.48,16.5,16.52,16.54,16.56,16.58,16.6,16.62,16.64,16.66,16.68,16.7,16.72,16.74,16.76,16.78,16.8,16.82,16.84,16.86,16.88,16.9,16.92,16.94,16.96,16.98,17,17.02,17.04,17.06,17.08,17.1,17.12,17.14,17.16,17.18,17.2,17.22,17.24,17.26,17.28,17.3,17.32,17.34,17.36,17.38,17.4,17.42,17.44,17.46,17.48,17.5,17.52,17.54,17.56,17.58,17.6,17.62,17.64,17.66,17.68,17.7,17.72,17.74,17.76,17.78,17.8,17.82,17.84,17.86,17.88,17.9,17.92,17.94,17.96,17.98,18,18.02,18.04,18.06,18.08,18.1,18.12,18.14,18.16,18.18,18.2,18.22,18.24,18.26,18.28,18.3,18.32,18.34,18.36,18.38,18.4,18.42,18.44,18.46,18.48,18.5,18.52,18.54,18.56,18.58,18.6,18.62,18.64,18.66,18.68,18.7,18.72,18.74,18.76,18.78,18.8,18.82,18.84,18.86,18.88,18.9,18.92,18.94,18.96,18.98,19,19.02,19.04,19.06,19.08,19.1,19.12,19.14,19.16,19.18,19.2,19.22,19.24,19.26,19.28,19.3,19.32,19.34,19.36,19.38,19.4,19.42,19.44,19.46,19.48,19.5,19.52,19.54,19.56,19.58,19.6,19.62,19.64,19.66,19.68,19.7,19.72,19.74,19.76,19.78,19.8,19.82,19.84,19.86,19.88,19.9,19.92,19.94,19.96,19.98,20,20.02,20.04,20.06,20.08,20.1,20.12,20.14,20.16,20.18,20.2,20.22,20.24,20.26,20.28,20.3,20.32,20.34,20.36,20.38,20.4,20.42,20.44,20.46,20.48,20.5,20.52,20.54,20.56,20.58,20.6,20.62,20.64,20.66,20.68,20.7,20.72,20.74,20.76,20.78,20.8,20.82,20.84,20.86,20.88,20.9,20.92,20.94,20.96,20.98,21,21.02,21.04,21.06,21.08,21.1,21.12,21.14,21.16,21.18,21.2,21.22,21.24,21.26,21.28,21.3,21.32,21.34,21.36,21.38,21.4,21.42,21.44,21.46,21.48,21.5,21.52,21.54,21.56,21.58,21.6,21.62,21.64,21.66,21.68,21.7,21.72,21.74,21.76,21.78,21.8,21.82,21.84,21.86,21.88,21.9,21.92,21.94,21.96,21.98,22,22.02,22.04,22.06,22.08,22.1,22.12,22.14,22.16,22.18,22.2,22.22,22.24,22.26,22.28,22.3,22.32,22.34,22.48,22.5,22.52,22.54,22.56,22.58,22.6,22.62,22.64,22.66,22.68,22.7,22.8,22.82,22.84,22.86,22.88,22.9,22.92,22.94,23.2,23.22,23.24,23.26,23.28,23.3,23.32,23.34,23.36,23.38,23.4,23.42,23.44,23.46,23.48,23.5,23.52,23.54,23.94,23.96,23.98,24,24.02,24.04,24.06,24.08,29.6,29.62,29.64,29.66,29.68,29.7,29.72,29.74,29.76,29.8,29.82,29.94,29.96,29.98,30,30.02,30.04,30.06,30.08,30.1,30.12,30.14,30.16,30.18,30.2,30.22,30.24,30.26,30.28,30.3,30.34,30.36,30.66,30.7,30.76,31.5,31.6,31.62,31.64,31.66,31.68,31.7,31.72,31.74,31.76,31.78,31.8,31.82,31.84,31.86,31.88,32.22,32.24,32.32,32.94,33,33.06,34.64,34.66,34.7,34.78,34.8,34.82,34.84,34.86,35.58,35.6,35.62,38.8,38.92,38.94,38.96,39.34,39.36,39.38,39.4,39.42,39.44,39.6,39.62,39.64,39.66,39.68,39.7,39.72,39.74,39.76,39.78,39.8,39.82,39.84,39.86,39.88,39.9,39.92,39.94,39.96,39.98,40,40.02,40.04,40.06,40.08,40.1,40.12,40.5,40.52,40.54,40.56,40.58,40.6,40.62,40.64,40.66,40.68,40.7,40.72,40.74,40.76,40.78,40.8,40.82,40.84,40.86,40.88,40.9,40.92,40.94,40.96,40.98,41,41.02,41.04,41.06,41.08,41.1,41.12,41.14,41.16,41.18,41.2,41.22,41.24,41.26,41.28,41.3,41.32,41.34,41.36,41.38,41.4,41.42,41.44,41.46,41.48,41.5,41.52,41.54,41.56,41.58,41.6,41.62,41.64,41.66,41.68,41.7,41.72,41.74,41.76,41.78,41.8,41.82,41.84,41.86,41.88,41.9,41.92,41.94,41.96,41.98,42,42.02,42.04,42.06,42.08,42.1,42.12,42.14,42.78,42.8,42.82,42.88,42.9,42.92,42.94,42.96,42.98,43,43.02,43.04,43.06,43.08,43.1,43.12,43.14,43.16,43.18,43.2,43.22,43.24,43.26,43.28,43.3,43.32,43.34,43.36,43.38,43.4,43.42,43.44,43.46,43.48,43.5,43.52,43.54,43.56,43.58,43.6,43.62,43.64,43.66,43.68,43.7,43.72,43.74,43.76,43.78,43.8,43.82,43.84,43.86,43.88,43.9,43.92,43.94,43.96,43.98,44,44.02,44.04,44.06,44.08,44.1,44.12,44.14,44.16,44.18,44.2,44.22,44.24,44.26,44.28,44.3,44.32,44.34,44.36,44.38,44.4,44.42,44.44,44.46,44.48,44.5,44.52,44.54,44.56,44.58,44.6,44.62,44.64,44.66,44.68,44.7,44.72,44.74,44.76,44.78,44.8,44.82,44.84,44.86,44.88,44.9,44.92,44.94,44.96,44.98,45,45.02,45.04,45.06,45.08,45.1,45.12,45.14,45.16,45.18,45.2,45.22,45.24,45.26,45.28,45.3,45.32,45.34,45.36,45.38,45.4,45.42,45.44,45.46,45.48,45.5,45.52,45.54,45.56,45.58,45.6,45.62,45.64,45.66,45.68,45.7,45.72,45.74,45.76,45.78,45.8,45.82,45.84,45.86,45.88,45.9,45.92,45.94,45.96,45.98,46,46.02,46.04,46.06,46.08,46.1,46.12,46.14,46.16,46.18,46.2,46.22,46.24,46.26,46.28,46.3,46.32,46.34,46.36,46.38,46.4,46.42,46.44,46.46,46.48,46.5,46.52,46.54,46.56,46.58,46.6,46.62,46.64,46.66,46.68,46.7,46.72,46.74,46.76,46.78,46.8,46.82,46.84,46.86,46.88,46.9,46.92,46.94,46.96,46.98,47,47.02,47.04,47.06,47.08,47.1,47.12,47.14,47.16,47.18,47.2,47.22,47.24,47.26,47.28,47.3,47.32,47.34,47.36,47.38,47.4,47.42,47.44,47.46,47.48,47.5,47.52,47.54,47.56,47.58,47.6,47.62,47.64,47.66,47.68,47.7,47.72,47.74,47.76,47.78,47.8,47.82,47.84,47.86,47.88,47.9,47.92,47.94,47.96,47.98,48,48.02,48.04,48.06,48.08,48.1,48.12,48.14,48.16,48.18,48.2,48.22,48.24,48.26,48.28,48.3,48.32,48.34,48.36,48.38,48.4,48.42,48.44,48.46,48.48,48.5,48.52,48.54,48.56,48.58,48.6,48.62,48.64,48.66,48.68,48.7,48.72,48.74,48.76,48.78,48.8,48.82,48.84,48.86,48.88,48.9,48.92,48.94,48.96,48.98,49,49.02,49.04,49.06,49.08,49.1,49.12,49.14,49.16,49.18,49.2,49.22,49.24,49.26,49.28,49.3,49.32,49.34,49.36,49.38,49.4,49.42,49.44,49.46,49.48,49.5,49.52,49.54,49.56,49.58,49.6,49.62,49.64,49.66,49.68,49.7,49.72,49.74,49.76,49.78,49.8,49.82,49.84,49.86,49.88,49.9,49.92,49.94,49.96,49.98,50,50.02,50.04,50.06,50.08,50.1,50.12,50.14,50.16,50.18,50.2,50.22,50.24,50.26,50.28,50.3,50.32,50.34,50.36,50.38,50.4,50.42,50.44,50.46,50.48,50.5,50.52,50.54,50.56,50.58,50.6,50.62,50.64,50.66,50.68,50.7,50.72,50.74,50.76,50.78,50.8,50.82,50.84,50.86,50.88,50.9,50.92,50.94,50.96,50.98,51,51.02,51.04,51.06,51.08,51.1,51.12,51.14,51.16,51.18,51.2,51.22,51.24,51.26,51.28,51.3,51.32,51.34,51.36,51.38,51.4,51.42,51.44,51.46,51.48,51.5,51.52,51.54,51.56,51.58,51.6,51.62,51.64,51.66,51.68,51.7,51.72,51.74,51.76,51.78,51.8,51.82,51.84,51.86,51.88,51.9,51.92,51.94,51.96,51.98,52,52.02,52.04,52.06,52.08,52.1,52.12,52.14,52.16,52.18,52.2,52.22,52.24,52.26,52.28,52.3,52.32,52.34,52.36,52.38,52.4,52.42,52.44,52.46,52.48,52.5,52.52,52.54,52.56,52.58,52.6,52.62,52.64,52.66,52.68,52.7,52.72,52.74,52.76,52.78,52.8,52.82,52.84,52.86,52.88,52.9,52.92,52.94,52.96,52.98,53,53.02,53.04,53.06,53.08,53.1,53.12,53.14,53.16,53.18,53.2,53.22,53.24,53.26,53.28,53.3,53.32,53.34,53.36,53.38,53.4,53.42,53.44,53.46,53.48,53.5,53.52,53.54,53.56,53.58,53.6,53.62,53.64,53.66,53.68,53.7,53.72,53.74,53.76
], dtype=float)

SAMPLED_YC = np.array([
0.708373100368999,0.705522392397999,0.705461576893,0.704964104263999,0.704554675309999,0.703817731546999,0.703880844571,0.706539936761,0.705731081992999,0.706624684653,0.706218842862999,0.706823287273,0.707359413162,0.707005301918999,0.70736856792,0.706883104963,0.706638429038,0.706819833605999,0.706557387199999,0.705629166933999,0.704444037832,0.703874592321,0.702737337551999,0.702551527856,0.701853043921999,0.701306440849999,0.701199450071,0.702114066263,0.701404519973999,0.701135333041999,0.700958262055999,0.700859284924999,0.700358213736,0.700263555616999,0.700574182689,0.699551683561999,0.698948930997,0.698529451483999,0.698500185406,0.698363807198,0.697277943319999,0.696299651496,0.695980115271,0.695879048194,0.695356590926999,0.695541532975999,0.695187647087999,0.694006447626999,0.694503730777999,0.694588924831999,0.693780025421999,0.693657537219999,0.693660254374,0.693475774367999,0.693047335496999,0.692689624663,0.692044350979999,0.691498572081,0.691132440211,0.691298748775,0.690997336258,0.690264570437999,0.690826717615999,0.690562193227999,0.690290651419,0.689662769078999,0.689296174163,0.688959755356999,0.688888948325999,0.688853136947,0.688771298645,0.688530464012,0.688785783031,0.688057775343,0.687118321551,0.687084334387,0.687407120467,0.687058268692999,0.686854398543,0.686270194497,0.685622266166,0.686185586327999,0.686035108852999,0.685257149571,0.685190950177999,0.685495429747999,0.684976499762,0.684679336907999,0.683838867565999,0.683822621251999,0.683638921317,0.683135523813999,0.682406545254999,0.682271219817999,0.681957627572999,0.681316949267,0.681070865946,0.680727548223999,0.680603569103,0.679881777641999,0.679457415651,0.678882127469,0.678273822298,0.677830765951999,0.677581789372,0.676222046189,0.676375254598999,0.676628204420999,0.676575435274,0.676414117508999,0.676299634623999,0.675717874177999,0.675471789227,0.675088678877999,0.674649943754999,0.674400910444,0.674056269753,0.673767549893,0.673520074412999,0.672782126941999,0.672278226958,0.671840677732,0.671015333015,0.670712579476999,0.671053525138,0.670238007336999,0.669659225272999,0.669368750116999,0.668897576672,0.668746702959,0.668279655277999,0.668065769954999,0.667536827076,0.667813281763999,0.667702177869,0.667630736295,0.668028003871,0.667661779842999,0.667325707557999,0.666609481417999,0.666573660080999,0.66666485118,0.666991591577999,0.667042963194999,0.666959951952999,0.666732766353999,0.666561925223,0.665440328543999,0.664947610905,0.664771008746,0.665044375237,0.665467587879999,0.665606720083,0.665578092052999,0.665240402178999,0.665000247692,0.665073466925,0.664913312079999,0.664498841868,0.665355167167999,0.665395176468,0.665433732578999,0.665022611528999,0.665137651809999,0.664986427466,0.664956302817,0.664400646703,0.664756739146999,0.664732528194999,0.664569214459,0.664990580940999,0.66513301564,0.664729041123,0.664364486825999,0.664619404383999,0.664310189612,0.663757417228999,0.663484180001,0.663235392666,0.663627526222,0.663280630264,0.663581184882,0.663429043591999,0.663209901355,0.663666973039,0.663721691979999,0.662464540362999,0.660548418985,0.660050286609999,0.659234820237999,0.658849847583,0.658115650907,0.658506962683999,0.657822317859999,0.656992104512999,0.657562979952999,0.656558381524999,0.656407800673999,0.657214782142999,0.657720315808,0.658472013132,0.659270029515,0.659532853415999,0.659261002262,0.658730094698,0.657827171975,0.657122229605,0.656501346711999,0.656559740038999,0.656702017195,0.656498433294,0.656198414842,0.655484910235,0.654408626451,0.653009249794999,0.652719671599999,0.652509745855,0.65267190758,0.651975684106,0.651407060623999,0.651722448256999,0.650656948781999,0.650329220019999,0.650425778474,0.649891418763,0.649921050832999,0.64902362613,0.648974308813999,0.649349551258,0.649075864371999,0.649382777283999,0.649563741103999,0.649600550713999,0.649805337517999,0.649955809285999,0.650496125066999,0.650830137585999,0.650891741997,0.65137107905,0.651372802191999,0.651745939417,0.652466268053,0.652952018984999,0.653831914935999,0.654235011459,0.654764040604,0.655171535040999,0.655261493931,0.655259195061,0.65559110066,0.655660026412999,0.655750705756999,0.655485365870999,0.655615810779999,0.655379406299,0.654636717646999,0.654853269911999,0.655080379841999,0.654854383722999,0.654790599488999,0.654966511702,0.655069079542,0.654963366997999,0.654168369024999,0.654712511881999,0.654787879030999,0.654554815877999,0.654286615352,0.653847897996,0.653174275861999,0.653433164321,0.653040299475999,0.652784828274999,0.652080672972999,0.651466904469,0.652091545097999,0.652228032533,0.652373379443999,0.652194890535,0.651877128717,0.652364593080999,0.652731148737,0.652639706024,0.652481797687,0.652352945251,0.651634422641,0.651344685625,0.650025021157999,0.649615590965,0.64941678873,0.6491495466,0.649578478625,0.649670348555,0.648930774369999,0.647945801449999,0.647232518489999,0.648359768826,0.648826241931,0.648257703369999,0.648152768799999,0.647490213776,0.647414151866999,0.647304929186999,0.646833118717,0.64632608252,0.644796087975999,0.643672777074999,0.641774050292999,0.641340284654,0.642622911630999,0.644601448383,0.644840610189,0.644414595045,0.644562037365,0.644842215148,0.644625174797999,0.644271852338,0.643576936198999,0.643920197215,0.644362643822999,0.644291013277,0.64356033316,0.642733884547,0.643302157339,0.643225502158,0.642569157614,0.642539565282,0.642227278999999,0.641630184163999,0.641575020197999,0.640368741783,0.640206410927999,0.640828566538,0.640848138225999,0.640569693884,0.640234543436999,0.640151733296999,0.640288769754999,0.639828347947999,0.639683308839999,0.639175465366,0.638144936272999,0.637549470340999,0.636699452297999,0.636249955751,0.637620923116999,0.638583597288999,0.638224895092999,0.638402346125,0.638594274132999,0.638460096799999,0.638300435818999,0.638100059309,0.63863930369,0.63881880563,0.639485847652999,0.640121982325999,0.641279134877,0.641645692393999,0.641475456426,0.641761061462,0.641378910839,0.641012639314,0.639406954055,0.639096580601,0.639344301622999,0.638976762426,0.638576586778999,0.638200324094,0.637799357772,0.637186942788,0.636211416481,0.636420346737,0.635452375572,0.635207492748,0.634823528388,0.634837692249,0.635198157762,0.635788354129,0.635662957897999,0.635943057669,0.635253586064,0.634646617927999,0.633424106727999,0.632696691586,0.632535480957999,0.631901089662999,0.63141437383,0.631246751216,0.631048800583999,0.630750123650999,0.630733264885,0.630184565646,0.629339573644999,0.628628329384,0.628288406781,0.626041154041,0.6256372118,0.62556741575,0.626062486135999,0.626347832564999,0.621267764553999,0.621437109168999,0.621413680096999,0.620407607442999,0.619196655343999,0.617670897966999,0.617687999659999,0.619076537515,0.597766193735999,0.59797902624,0.597234338393,0.59601137283,0.595372798850999,0.595001282672,0.594250164185,0.593322577433999,0.593068095621999,0.589523413479,0.588124044783,0.587325426278,0.585322846019,0.584911458272999,0.585481224154999,0.584736870787,0.583370748643999,0.582299163462,0.581562477708999,0.581068138118999,0.583090504861999,0.584398320626999,0.582642939626,0.580562388974999,0.580916498637,0.581703158937,0.582814434534,0.581463575704,0.579875983438,0.579061563653999,0.579458614327999,0.578784508292,0.575042927136,0.570757379908999,0.573451066388999,0.560187973699,0.557786205862999,0.557380620561999,0.557058492129,0.556644980671999,0.556197074271,0.555700718864,0.555998262467,0.555885906487,0.555511080304999,0.555206829087999,0.554634328397999,0.554551740321,0.554222973926,0.553957259098,0.553411550465999,0.545569529719999,0.545950868212,0.551858256556,0.540011019163,0.533616123585999,0.528580847704999,0.46551623934,0.464261922726,0.463888265756,0.460035087755,0.459360197029,0.457291141632,0.455432958940999,0.454406498021,0.429107953907,0.427382482789999,0.425933989861999,0.417802556166999,0.419129310657,0.419120999675999,0.418935436276,0.420262037899999,0.420577373992999,0.420650178078,0.420647384933,0.419889235751,0.419851717936999,0.420510463169999,0.420710131715999,0.420359729238,0.42058257234,0.420841912288,0.420455597784,0.419431607402999,0.419692531325999,0.419495543178999,0.419898501866,0.419934828056,0.419961758326999,0.420577019682,0.420220233463,0.420171002562,0.420072734548,0.420355957101999,0.420653569032999,0.420938820163999,0.420498720412,0.420575410281,0.420568111351,0.420713269224999,0.420880971940999,0.420455594422999,0.420796863427999,0.420687056885,0.420558459901999,0.421490324758999,0.421857565400999,0.422269312372999,0.422064693952,0.421801821659999,0.422530274607,0.422613222593999,0.42221981025,0.422710178056,0.422994928915,0.422907801808999,0.422998976105999,0.423881992823,0.423351220914999,0.423431965828999,0.423117800289999,0.423677829225999,0.424014890679,0.423735776612999,0.424292977812999,0.42424057848,0.42444075398,0.424348827631999,0.424114880176999,0.424230107982999,0.424630081054,0.424837909707999,0.425177392063,0.425152444526,0.425317733067,0.425413174821999,0.425527268573,0.426047572516999,0.426267405116,0.42588041715,0.425548216610999,0.425991191668999,0.426182516921999,0.426111190739999,0.426101362608999,0.426035148751999,0.425856577782999,0.425467721030999,0.426150081978999,0.42613225618,0.426050856651,0.426493612341,0.426199420697999,0.426308758108,0.426080681031999,0.42650187898,0.426334880003,0.426479333843999,0.426390467826,0.426315599003999,0.426701207404,0.426914892556999,0.426626058713,0.427222237645,0.427453080436999,0.428078857106999,0.428182987672,0.428570938373999,0.428847269681,0.429232802591999,0.429339676870999,0.429520873452999,0.429824387125999,0.430020937961,0.42986380342,0.430566625503,0.431021933843999,0.431316705704,0.43148958233,0.431410215639999,0.432098222787999,0.432112114032,0.432592911015,0.432796668888999,0.433062896641999,0.433193724933999,0.433283020003999,0.436371561240999,0.437005656202,0.437366419613999,0.435416557463,0.436518510812999,0.437837025096999,0.438743889932999,0.439939482524,0.440532552602999,0.441024823633999,0.44132002669,0.441667023626,0.442362908001999,0.442802148891999,0.44329355126,0.443542442252999,0.443726363279999,0.443992671051,0.444535049153999,0.444803568115,0.445401617209999,0.445744013993,0.445860285713999,0.445779536856999,0.446162264225999,0.446524860966999,0.44658431586,0.446740254026,0.447023460516999,0.446816736846,0.447176954351999,0.447493019774,0.448810640766,0.448850743688,0.448911479692,0.449148111678,0.449264831968999,0.449145452744,0.449426441728999,0.449312956905,0.448825647155,0.448961365823999,0.448984973363999,0.448819163887999,0.448480389199999,0.448939317367,0.449262950321999,0.449764056439999,0.449930229237999,0.450134365710999,0.450513231345,0.450820928557,0.451010607502,0.451310087828,0.450970637774,0.450892071563999,0.45083546308,0.450852893047,0.450416791352,0.450277458228,0.450109774334,0.449881147541,0.450800810270999,0.451148486018,0.451426683007,0.451476404494,0.451698795238999,0.451552486070999,0.451794023746999,0.451621754566999,0.451976253563999,0.452000768656999,0.452048566559999,0.452099254325999,0.452621009357999,0.452676508416999,0.452810419629,0.45304831758,0.453082247289999,0.452884328149999,0.453207883271,0.453359391485,0.453769615975,0.453761712402,0.453738023736,0.453701659339999,0.453822646369999,0.454412989983999,0.454355654028,0.454494612463,0.454519125341999,0.454428598146,0.454464028359999,0.454713090566999,0.454644611634,0.454589738431,0.454711334134,0.454808663097,0.455134592806,0.455188974579999,0.455176991018,0.455773517910999,0.456051906966999,0.456223678333,0.455965448051,0.455398544271999,0.455176865825999,0.455041602087999,0.454713236818999,0.454287914176,0.454332798309999,0.454318776029999,0.454020145567999,0.454076707284,0.454762849215,0.455229922183999,0.455893455721,0.455790619352,0.456013284270999,0.456699814120999,0.456700144315999,0.456815828907,0.456671626774,0.457203796085,0.457689748151999,0.457802449799999,0.457634016019,0.457948027516,0.458119226115999,0.458054861474999,0.457991896994,0.458550296242999,0.458803963005,0.459129703819999,0.458999770467,0.458998574766999,0.459166603407,0.459604022932,0.460050299863,0.460341798897999,0.460123865941,0.459638406406999,0.459860229797999,0.45970901621,0.459867012219999,0.460197916587999,0.460325216531,0.460223711732,0.460356802851999,0.460532903778999,0.460784352103999,0.460881733720999,0.460947366527999,0.461053705341,0.461247842289,0.461523026893999,0.461471116683999,0.461286636715999,0.461619416879,0.462039972094999,0.461966194012,0.462154007822999,0.462323011877999,0.462617284971999,0.463269612923,0.463204697710999,0.463206990854,0.462889182283,0.463020786068,0.4630246928,0.462988319031999,0.463096944688,0.463558134568,0.463553806396,0.46378070401,0.464034285684999,0.464094889024999,0.464214076992999,0.464862197954999,0.464836110899,0.464873670296999,0.465102052067999,0.464888675465999,0.465185003859,0.465458009736999,0.465695852632,0.466237804208,0.466338593248999,0.466932180560999,0.466919147343,0.466943841680999,0.466958414359,0.467023313561999,0.467284025949,0.467672366045999,0.467793575476999,0.46749011365,0.468239621205999,0.468573253011,0.468956941556,0.468387209870999,0.468661006036,0.468487497091,0.468847995047999,0.469180849638999,0.469116904211,0.469014842236999,0.469076385227999,0.468899702011999,0.469016354136,0.469494837685999,0.469870740996999,0.469528197275,0.469777065972999,0.470178110269,0.470389912799999,0.470440337252999,0.470579511702999,0.470818686338,0.471145653777999,0.471096302880999,0.470969196235,0.471059936019,0.471390907575,0.471210049943999,0.471164263114999,0.470985043286,0.471738090953999,0.471845196949,0.471958456341999,0.471769059207999,0.471667387791,0.471639311406999,0.472045832936,0.472349620965999,0.472626656344,0.47288098306,0.473176064328999,0.473439130954999,0.473428190859999,0.473723885148,0.473758283521,0.474178276627,0.474243799189,0.47447128572,0.474591717755999,0.474557309723999,0.474595022986999,0.474653538379999,0.474919276835999,0.474600455587999,0.474554931538,0.474682378164999,0.474747673066,0.474728678147999,0.474651946715999,0.474654166025999,0.475001225728999,0.474735136252,0.474960158502,0.475007545454,0.474943521814,0.474864353628,0.475308953352999,0.475291763473999,0.475703383601999,0.475924884184999,0.476082080759,0.476306723292,0.476418297515999,0.47666340758,0.476470086314,0.476809323829999,0.476802587888,0.477118856751999,0.477489610373,0.477470323088999,0.477896205543,0.477506120377,0.477772438534999,0.477828451954,0.477723531101999,0.478155381205,0.478485950349999,0.478513568627999,0.478560473777,0.478683327686999,0.47907482705,0.479015930754999,0.479021244447,0.479446268154999,0.479443561090999,0.479452472052,0.479664363811999,0.480206317544999,0.480133080451,0.480088446304999,0.480292904944999,0.480592230003999,0.481988239476999,0.48298147502,0.483574076656999,0.483641051849999,0.48393546241,0.484209901748999,0.483924819651,0.484386456333,0.484509150834,0.484964192797999,0.484729715140999,0.484839421900999,0.485237145435,0.484903603325999,0.484399462104,0.484151219504999,0.484165457031,0.484468817224,0.484442315333,0.484615014405,0.484901812762,0.485060373507999,0.485046014065999,0.485235085652,0.48532683902,0.486002487969,0.486175709779999,0.486345789405999,0.486267129005,0.486606878863,0.486399446916999,0.486496146092,0.486447895572999,0.486591682638999,0.486535654704,0.486749313159999,0.487202269381999,0.487189502027999,0.487640796874999,0.488160663139999,0.488085586964,0.488135298627999,0.488187450363999,0.488333651404,0.488624181818,0.488540782096999,0.488620862204999,0.488688480326999,0.488947048601999,0.489679464230999,0.489741077242,0.490248972289999,0.490721858273,0.491003456690999,0.491201268624,0.491283723931999,0.491654749734999,0.491913170811999,0.492123347431,0.492455915903,0.491982369203,0.492255652009,0.492783130699,0.492954330398,0.493036734562999,0.492870346959,0.492393271966999,0.493113674259999,0.493208247163999,0.493794296813,0.493907458942,0.494169851140999,0.494587008247,0.494635040833999,0.494827820696999,0.495313237379999,0.49561409011,0.495463119039999,0.49556865697,0.496095890187,0.495994597739,0.496460797699,0.496335419052,0.496552158338,0.496493337614999,0.496452319927,0.497331886376999,0.496989198741999,0.497737255898999,0.49752902211,0.497753967348,0.497733523208999,0.498362727892999,0.498462601591999,0.498321244832999,0.498608116116,0.49905394674,0.499392153781999,0.498755354511999,0.498787253670999,0.499496627166999,0.499463856941,0.499773890465,0.499674502112,0.4999710759,0.500167613507999,0.500240164720999,0.500309331992,0.499956252671,0.500156682440999,0.500426258969999,0.500609002169,0.500825642292999,0.500612027063,0.501143185634,0.500946225261999,0.501347964052999,0.501614774821,0.501982144138,0.501845243492999,0.502429725028,0.502229246289,0.502332447501999,0.502396137027,0.502796971717,0.502862530218,0.502889540682,0.503413998466999,0.503725412588999,0.503487044248,0.503535395149999,0.503252312276999,0.503632324530999,0.504169237373999,0.504326480058,0.504439132406999,0.504615354964,0.505202907520999,0.505217478203999,0.50530798812,0.505438694817999,0.505089666889999,0.504830088267,0.505254123923999,0.505328596318999,0.505676098662,0.506039334558,0.506192911367,0.506007356343,0.506200468225,0.506574704359999,0.506506964730999,0.50707912176,0.506901991081,0.506896675768,0.507203794969,0.506954995533999,0.507375790476,0.507163818619999,0.507537282957999,0.50787457845,0.507927195080999,0.508477402670999,0.508568994947,0.508863034423999,0.508866078024999,0.509142940672999,0.509351823025999,0.50970236939,0.509924337003999,0.509984997782999,0.509883740084999,0.510144801554,0.510318723819,0.510874603354999,0.510338140744999,0.510578968427999,0.511137965291999,0.511561430416999,0.5116349539,0.511635258125999,0.511886728974999,0.51194831146,0.511829145486,0.511903546694999,0.512007527446,0.512453313076999,0.512129627476999,0.512867669995,0.512840176533999,0.512927568633999,0.51292789167,0.513041756760999,0.513080966272999,0.513477442544,0.513577747801999,0.513463560436999,0.513340660156,0.513771231190999,0.513995678973,0.513924571551999,0.514419342939999,0.514451099492,0.514536225113999,0.514813257851999,0.514893074533999,0.515503451903,0.515393834691,0.51582504409,0.515894776923999,0.515931261272,0.516515072026999,0.517142347507999,0.517374518861999,0.517671667948,0.517516260623999,0.517505506203999,0.517848711983,0.518224952372999,0.518184726964999,0.518367053327999,0.518391896273,0.518883361414999,0.519279434249,0.519173922718999,0.519281117182,0.519006458150999,0.519080195713999,0.519347438130999,0.519049405199,0.518977825032,0.518865925738999,0.518631624028,0.518537114837999,0.519256015287999,0.519617925793,0.51917128213,0.519670050285999,0.519948319153,0.520348754901999,0.520680273673999,0.520588792099999,0.520965112914999,0.521502401867,0.521398692943,0.521636116267,0.522154713142999,0.522766568948999,0.523463041645999
], dtype=float)


def generate_underworld_profile(num_points: int = 300) -> np.ndarray:
    """Return an interpolated profile based on the Underworld sample."""
    x = np.linspace(SAMPLED_XC.min(), SAMPLED_XC.max(), num_points)
    y = np.interp(x, SAMPLED_XC, SAMPLED_YC)
    x_scaled = (x - x.min()) / (x.max() - x.min()) * 4 - 2
    return np.column_stack((x_scaled, normalize(y)))


def generate_profile(num_points: int = 300, source: str = "underworld") -> np.ndarray:
    """Generate a profile either from Underworld data or the sine generator."""
    if source == "underworld":
        return generate_underworld_profile(num_points)
    if source == "sine":
        return generate_sine_profile(num_points)
    raise ValueError("source must be 'underworld' or 'sine'")


def create_dataset(num_samples: int, save_dir: str, source: str = "underworld") -> Tuple[np.ndarray, np.ndarray]:
    """Generate num_samples profiles of the given source and save them."""
    os.makedirs(save_dir, exist_ok=True)

    X, Y = [], []
    for _ in range(num_samples):
        profile = generate_profile(num_points=300, source=source)
        X.append([profile[0, 1], profile[-1, 1]])
        Y.append(profile[:, 1])

    X_arr = np.array(X)
    Y_arr = np.array(Y)

    name = uuid.uuid4().hex
    np.save(os.path.join(save_dir, f"X_{name}.npy"), X_arr)
    np.save(os.path.join(save_dir, f"Y_{name}.npy"), Y_arr)
    return X_arr, Y_arr
